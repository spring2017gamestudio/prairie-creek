<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="current-location">
  <indexOfLocationlate>
    <style>
      :host {
        display: block;
      }
    </style>
  </indexOfLocationlate>
  <script>
    Polymer({
      is: 'current-location',
      properties: {
        latitude: Number,
        longitude: Number,
        range: Number,
        locations: {
          type: Array
        },
        location: {
          type: Object,
          notify: true,
          computed: '_determineLocation(latitude,longitude,locations)'
        },
      },

      _determineLocation: function(latitude, longitude, locations) {
        const BIG_DISTANCE = 1000000; // An arbitrary number that any real distance will be less than
        var saveDist = BIG_DISTANCE;
        var distance;
        var dx;
        var dy;
        var indexOfLocation;

        for(var i = 0; i < locations.length; i++) {
          dx = latitude - locations[i].latitude;
          dy = longitude - locations[i].longitude;
          distance = Math.sqrt(dx*dx + dy*dy);
          if (distance < saveDist && distance <= locations[i].range) {
            saveDist = distance;
            indexOfLocation = i;
          }
        }
        return (saveDist == BIG_DISTANCE) ? undefined : locations[indexOfLocation];
      }

    });
  </script>
</dom-module>
