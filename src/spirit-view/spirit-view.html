<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../view-behavior/view-behavior.html">

<dom-module id="spirit-view">
  <template>
    <style>
      :host {
        display: block;
      }
      img {
        width: 80%;
        height: 80%;
      }
    </style>
    <img src="{{selectedSpirit.image}}"></img>
    <br>
    [[selectedSpirit.text]]
    <br>
    <paper-button raised on-tap="_next">Go to collections screen</paper-button>
  </template>
  <script>
    Polymer({
      is: 'spirit-view',
      behaviors: [ViewBehavior],
      properties: {
        mapData: {
          type: Object,
          notify: true
        },
        spiritData: {
          type: Object,
          notify: true
        },
        selectedSpirit: {
          type: Object,
          notify: true,
          computed: '_currentSpiritText(mapData,spiritData)'
        }
      },

      _currentSpiritText: function(mapData,spiritData) {
        var spiritValue = 0;
        for(var i=0;i<mapData.length;i++) {
          for(var j=0;j<mapData[i].responses.length;j++) {
            spiritValue += (mapData[i].responses[j].selected ? mapData[i].responses[j].value : 0);
          }
        }
        return spiritData[Math.sign(spiritValue)+1];
      },

      _next: function() {
        this._goToPage('collection');
      }
    });
  </script>
</dom-module>
